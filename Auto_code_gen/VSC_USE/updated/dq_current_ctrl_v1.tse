version = 4.2

//
// Saved by sw version: 2025.1 SP1
//

model "dq_current_ctrl_v1" {
    configuration {
        hil_device = "HIL404"
        hil_configuration_id = 5
        simulation_method = exact
        simulation_time_step = auto
        simulation_discret_scaling = 1.0
        dsp_timer_periods = 100e-6, 50e-3
        ss_calc_method = "systematic elimination"
        enb_pole_shift = True
        enb_gds_oversampling = True
        show_modes = False
        device_ao_limit_enable = False
        reset_analog_outputs_on_sim_stop = True
        reset_analog_outputs_on_sim_stop_mode = Offset values
        reset_digital_outputs_on_sim_stop = True
        vhil_adio_loopback = False
        cpl_stb = False
        enb_dep_sw_detect = False
        code_section = "internal memory"
        data_section = "internal memory"
        sys_sp_rate_1 = 0.0001
        sys_sp_rate_2 = 0.05
        sys_real_type_precision = "default"
        user_real_type_precision = "default"
        sys_cpu_optimization = "high"
        user_cpu_optimization = "high"
        user_cpu_part_option = "default"
        matrix_based_reduction = True
        cpl_dynamics_analysis = False
        export_ss_to_pickle = False
        ground_scope_core = False
        dss_num_tol = 1e-15
        cce_platform = "launchxl-f28379d"
        cce_use_relative_names = False
        cce_type_mapping_real = "launchxl-f28379d"
        cce_type_mapping_uint = "unsigned int"
        cce_type_mapping_int = "int"
        cce_platform = "launchxl-f28379d"
        cce_use_relative_names = False
        cce_type_mapping_real = "launchxl-f28379d"
        cce_type_mapping_uint = "unsigned int"
        cce_type_mapping_int = "int"
        cce_term_var_location = "local"
        cce_directory = ""
        cce_custom_type_int = ""
        cce_custom_type_uint = ""
        cce_custom_type_real = ""
        tunable_params = "component defined"
        sp_compiler_type = "C compiler"
        sig_stim = "off"
        export_resource_list = ""
        export_dependency_list = ""
        excluded_resource_list = ""
        excluded_component_from_locking_list = ""
        export_out_file = ""
        export_lock_top_level = True
        export_encrypt_library = True
        export_encrypt_resources = True
        solver_type = "DAE"
        integration_method = "BDF"
        max_sim_step = 1e-4
        simulation_time = 1.0
        abs_tol = 1e-3
        rel_tol = 1e-3
        init_sim_step = 1e-6
        r_on_sw = 1e-3
        v_on_diode = 0.2
        data_sampling_rate = 0
        feedthrough_validation_error_level = warning
    }

    component Subsystem Root {
        component Subsystem dq_current_ctrl {
            layout = dynamic
            component "core/C function" "C function abc to dq" {
                arb_defs = "/*Begin code section*/

/*End code section*/"
                execution_rate = "Ts_Control"
                input_terminals = "real abc;real theta;"
                input_terminals_dimensions = "3;1"
                input_terminals_feedthrough = "True;True"
                input_terminals_show_labels = "True;True"
                output_fnc = "/*Begin code section*/
d= 2.0/3.0*(cos(theta)*abc[0] + cos(theta - 2.0/3.0*M_PI)*abc[1]  + cos(theta + 2.0/3.0*M_PI)*abc[2] );
q = 2.0/3.0*(-sin(theta)*abc[0] - sin(theta - 2.0/3.0*M_PI)*abc[1]  - sin(theta + 2.0/3.0*M_PI)*abc[2] );
/*End code section*/"
                output_terminals = "real d;real q;"
                output_terminals_dimensions = "1;1"
                output_terminals_feedthrough = "True;True"
                output_terminals_show_labels = "True;True"
            }
            [
                position = 7012, 7812
                size = 176, 152
            ]

            component "core/Bus Join" "Bus Join3" {
                execution_rate = "Ts_Control"
                inputs = "3"
            }
            [
                position = 6704, 7756
            ]

            component "core/C function" "C function PLL" {
                arb_defs = "/*Begin code section*/

/*End code section*/"
                execution_rate = "Ts_Control"
                global_variables = "real y_q;real theta;"
                init_fnc = "/*Begin code section*/
y_q = 0;
theta = 0;
/*End code section*/"
                input_terminals = "real abc;inherit init_pll;"
                input_terminals_dimensions = "3;inherit"
                input_terminals_feedthrough = "True;True"
                input_terminals_show_labels = "True;True"
                output_fnc = "/*Begin code section*/
// dq transformation
d= 2.0/3.0*(cos(theta)*abc[0] + cos(theta - 2.0/3.0*M_PI)*abc[1]  + cos(theta + 2.0/3.0*M_PI)*abc[2] );
q = 2.0/3.0*(-sin(theta)*abc[0] - sin(theta - 2.0/3.0*M_PI)*abc[1]  - sin(theta + 2.0/3.0*M_PI)*abc[2] );

//error
e_q = q;

//omega
omega_pll = K_p_pll*e_q + y_q;
//theta
theta_pll = theta;
/*End code section*/"
                output_terminals = "real d;real q;real theta_pll;real omega_pll;real e_q;"
                output_terminals_dimensions = "1;1;1;1;1"
                output_terminals_feedthrough = "True;True;True;True;True"
                output_terminals_show_labels = "True;True;True;True;True"
                parameters = "real K_p_pll;real K_i_pll;real Ts_Control;"
                update_fnc = "/*Begin code section*/
// Integrator of the PLL
y_q= y_q + K_i_pll*Ts_Control*e_q;
// Integrator of theta
theta = theta + Ts_Control*omega_pll;
if (init_pll<0.5){
    theta = 0;
    y_q = 0;
}

if (theta>=2*M_PI){
    theta = theta - 2*M_PI;
}
if (theta<0.0){
    theta = theta + abs(theta);
}
/*End code section*/"
            }
            [
                position = 7008, 7480
                size = 224, 304
            ]

            component "core/Bus Join" "Bus Join4" {
                execution_rate = "Ts_Control"
                inputs = "3"
            }
            [
                position = 6716, 7344
            ]

            component "core/Termination" Termination3 {
            }
            [
                position = 7208, 7608
            ]

            component "core/Bus Join" "Bus Join5" {
                execution_rate = "Ts_Control"
            }
            [
                position = 7188, 7808
            ]

            component "core/C function" "C function PI current controller" {
                arb_defs = "/*Begin code section*/

/*End code section*/"
                execution_rate = "Ts_Control"
                global_variables = "real y_d;real y_q;real e_d;real e_q;"
                init_fnc = "/*Begin code section*/
e_d = 0.0;
e_q = 0.0;
y_d = 0.0;
y_q = 0.0;
/*End code section*/"
                input_terminals = "real is_dq_ref;real is_dq;real vs_dq;real omega_pll;real v_dc;real reset_int;"
                input_terminals_dimensions = "2;2;2;1;1;1"
                input_terminals_feedthrough = "True;True;True;True;True;True"
                input_terminals_show_labels = "True;True;True;True;True;True"
                output_fnc = "/*Begin code section*/
//modulating signal computation
eta_d = (2/v_dc) * (Kp_i*e_d + y_d -   L*omega_pll*is_dq[1] + vs_dq[0]);
eta_q = (2/v_dc )* (Kp_i*e_q + y_q +  L*omega_pll*is_dq[0] + vs_dq[1]);
/*End code section*/"
                output_terminals = "real eta_d;real eta_q;"
                output_terminals_dimensions = "1;1"
                output_terminals_feedthrough = "True;True"
                output_terminals_show_labels = "True;True"
                parameters = "real Kp_i;real Ki_i;real Ts_Control;real L;real T_on_contactor;"
                update_fnc = "/*Begin code section*/
//error
e_d = is_dq_ref[0] - is_dq[0];
e_q = is_dq_ref[1] - is_dq[1];
//integrator
y_d = y_d + Ki_i*Ts_Control*e_d;
y_q = y_q + Ki_i*Ts_Control*e_q;
if (reset_int<0.5){
    y_d = 0;
    y_q = 0;
}
/*End code section*/"
            }
            [
                position = 8832, 7596
                size = 256, 320
            ]

            component "core/Bus Join" "Bus Join6" {
                execution_rate = "Ts_Control"
            }
            [
                position = 7240, 7388
            ]

            component "core/Bus Join" "Bus Join8" {
                execution_rate = "Ts_Control"
            }
            [
                position = 9060, 7576
            ]

            component "core/C function" "C function dq to abc" {
                arb_defs = "/*Begin code section*/

/*End code section*/"
                execution_rate = "Ts_Control"
                input_terminals = "real dq;real theta;"
                input_terminals_dimensions = "2;1"
                input_terminals_feedthrough = "True;True"
                input_terminals_show_labels = "True;True"
                output_fnc = "/*Begin code section*/
a= cos(theta)*dq[0] - sin(theta)*dq[1];
b= cos(theta -2.0/3.0*M_PI)*dq[0]  - sin(theta-2.0/3.0*M_PI)*dq[1];
c= cos(theta +2.0/3.0*M_PI)*dq[0] - sin(theta+2.0/3.0*M_PI)*dq[1];
/*End code section*/"
                output_terminals = "real a;real b;real c;"
                output_terminals_dimensions = "1;1;1"
                output_terminals_feedthrough = "True;True;True"
                output_terminals_show_labels = "True;True;True"
            }
            [
                position = 9560, 7572
                size = 176, 152
            ]

            component "core/Bus Join" "Bus Join9" {
                execution_rate = "Ts_Control"
                inputs = "3"
            }
            [
                position = 9752, 7572
            ]

            component "TI C2000 Toolbox/ADC (Generic)" "ADC (Generic)1" {
                conv_trigger = "ePWM6"
                execution_rate = "Ts_Control"
                hil_ao_nr = "4"
                inten = "True"
                offset = "AO_offset"
                scaling = "I_scale"
            }
            [
                position = 6020, 7708
                size = 127, 63
            ]

            component "TI C2000 Toolbox/ADC (Generic)" "ADC (Generic)2" {
                conv_trigger = "ePWM6"
                execution_rate = "Ts_Control"
                hil_ao_nr = "5"
                inten = "True"
                offset = "AO_offset"
                scaling = "I_scale"
            }
            [
                position = 6020, 7808
                size = 127, 63
            ]

            component "TI C2000 Toolbox/ADC (Generic)" "ADC (Generic)3" {
                conv_trigger = "ePWM6"
                execution_rate = "Ts_Control"
                hil_ao_nr = "6"
                inten = "True"
                offset = "AO_offset"
                scaling = "I_scale"
            }
            [
                position = 6028, 7916
                size = 127, 63
            ]

            component "TI C2000 Toolbox/ADC (Generic)" "ADC (Generic)4" {
                conv_trigger = "ePWM6"
                execution_rate = "Ts_Control"
                inten = "True"
                offset = "AO_offset"
                scaling = "V_scale"
            }
            [
                position = 6024, 7284
                size = 127, 63
            ]

            component "TI C2000 Toolbox/ADC (Generic)" "ADC (Generic)5" {
                conv_trigger = "ePWM6"
                execution_rate = "Ts_Control"
                hil_ao_nr = "2"
                inten = "True"
                offset = "AO_offset"
                scaling = "V_scale"
            }
            [
                position = 6024, 7384
                size = 127, 63
            ]

            component "TI C2000 Toolbox/ADC (Generic)" "ADC (Generic)6" {
                conv_trigger = "ePWM6"
                execution_rate = "Ts_Control"
                hil_ao_nr = "3"
                inten = "True"
                offset = "AO_offset"
                scaling = "V_scale"
            }
            [
                position = 6032, 7492
                size = 127, 63
            ]

            component "TI C2000 Toolbox/ePWM (Generic)" "ePWM (Generic)1" {
                hil_di_nr = "1-3-5"
                hil_di_nr_b = "2-4-6"
                nr_of_channels = "3"
            }
            [
                position = 10416, 7600
                size = 127, 63
            ]

            component "core/Sum" Sum1 {
                execution_rate = "Ts_Control"
            }
            [
                position = 10120, 7600
            ]

            component "core/Constant" Constant1 {
                execution_rate = "Ts_Control"
            }
            [
                position = 10012, 7620
            ]

            component "core/Gain" Gain1 {
                execution_rate = "Ts_Control"
                gain = "0.5"
            }
            [
                position = 10196, 7600
            ]

            component "core/Bus Split" "Bus Split1" {
                execution_rate = "Ts_Control"
                outputs = "3"
            }
            [
                position = 10268, 7600
            ]

            component "TI C2000 Toolbox/SCI Setup (Generic)" "SCI Setup1" {
                baudrate = "115200"
                execution_rate = "Tslow"
                scilbaud = "53"
            }
            [
                position = 7972, 7516
                size = 127, 63
            ]

            component "TI C2000 Toolbox/SCI Receive (Generic)" "SCI Receive1" {
                execution_rate = "Ts_Control"
                timeout = "0"
                var_names = "id_ref,iq_ref,init_pll,reset_int"
                vct_size = "4"
            }
            [
                position = 7592, 7516
                size = 127, 144
            ]

            component "TI C2000 Toolbox/SCI Send (Generic)" "SCI Send1" {
                var_names = "is_d, is_q,vs_d,vs_q"
                vct_size = "4"
            }
            [
                position = 8296, 7508
                size = 127, 144
            ]

            component "core/Bus Join" "Bus Join11" {
                execution_rate = "Ts_Control"
            }
            [
                position = 7772, 7484
            ]

            component "TI C2000 Toolbox/GPIO DO (Generic)" "GPIO DO (Generic)1" {
                hil_di_nr = "12"
                pin_action = "Pin Ctrl"
            }
            [
                position = 7780, 7700
                size = 127, 63
            ]

            component "TI C2000 Toolbox/ePWM (Generic)" "ePWM (Generic)2" {
                dead_time = "0"
                frequency = "20e3"
                hil_di_nr = "13"
                hil_di_nr_b = "14"
                soc_en = "True"
                soc_timing = "Counter equals zero or period"
            }
            [
                position = 10412, 7724
                size = 127, 63
            ]

            component "core/Constant" Constant2 {
                execution_rate = "Ts_Control"
                value = "0.5"
            }
            [
                position = 10268, 7724
            ]

            component "core/Constant" Constant3 {
                execution_rate = "Ts_Control"
                value = "800"
            }
            [
                position = 8604, 7680
            ]

            component "core/Constant" Constant4 {
                execution_rate = "Ts_Control"
            }
            [
                position = 7392, 8056
            ]

            component "core/Sum" Sum2 {
                execution_rate = "Ts_Control"
                signs = "+-"
            }
            [
                position = 7520, 8064
            ]

            component "core/Delay" Delay1 {
                del_length = "1"
                execution_rate = "Ts_Control"
            }
            [
                position = 7516, 8180
                rotation = down
            ]

            component "TI C2000 Toolbox/GPIO DO (Generic)" "GPIO DO (Generic)2" {
                hil_di_nr = "7"
                pin_action = "Pin Ctrl"
            }
            [
                position = 7688, 8064
                size = 127, 63
            ]

            tag From57 {
                value = "is_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6568, 7724
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From58 {
                value = "is_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6576, 7756
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From59 {
                value = "is_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6568, 7800
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From61 {
                value = "vs_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6548, 7324
                hide_name = True
                size = 60, 20
            ]

            tag From62 {
                value = "vs_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6548, 7348
                hide_name = True
                size = 60, 20
            ]

            tag From63 {
                value = "vs_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6548, 7372
                hide_name = True
                size = 60, 20
            ]

            tag Goto35 {
                value = "theta"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7208, 7480
                hide_name = True
                size = 60, 20
            ]

            tag Goto36 {
                value = "omega"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7200, 7544
                hide_name = True
                size = 60, 20
            ]

            tag From66 {
                value = "theta"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6828, 7868
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto37 {
                value = "is_dq"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7284, 7808
                hide_name = True
                size = 60, 20
            ]

            tag From67 {
                value = "is_dq"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8600, 7512
                hide_name = True
                size = 60, 20
            ]

            tag Goto38 {
                value = "vs_dq"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7328, 7388
                hide_name = True
                size = 60, 20
            ]

            tag From68 {
                value = "vs_dq"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8596, 7568
                hide_name = True
                size = 60, 20
            ]

            tag From69 {
                value = "omega"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8604, 7624
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From71 {
                value = "is_dq_ref"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8604, 7456
                hide_name = True
                size = 60, 20
            ]

            tag Goto40 {
                value = "eta_dq"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9164, 7576
                hide_name = True
                size = 60, 20
            ]

            tag From72 {
                value = "eta_dq"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9344, 7516
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From73 {
                value = "theta"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9352, 7628
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto41 {
                value = "eta_abc"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9848, 7572
                hide_name = True
                size = 60, 20
            ]

            tag From74 {
                value = "eta_abc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10004, 7572
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto43 {
                value = "is_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6216, 7708
                hide_name = True
                size = 60, 20
            ]

            tag Goto44 {
                value = "is_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6208, 7808
                hide_name = True
                size = 60, 20
            ]

            tag Goto45 {
                value = "is_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6208, 7916
                hide_name = True
                size = 60, 20
            ]

            tag Goto46 {
                value = "vs_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6220, 7284
                hide_name = True
                size = 60, 20
            ]

            tag Goto47 {
                value = "vs_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6212, 7384
                hide_name = True
                size = 60, 20
            ]

            tag Goto48 {
                value = "vs_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6212, 7492
                hide_name = True
                size = 60, 20
            ]

            tag Goto50 {
                value = "vs_d"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7304, 7296
                hide_name = True
                size = 60, 20
            ]

            tag Goto51 {
                value = "vs_q"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7328, 7452
                hide_name = True
                size = 60, 20
            ]

            tag Goto52 {
                value = "is_d"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7244, 7704
                hide_name = True
                size = 60, 20
            ]

            tag Goto49 {
                value = "is_dq_ref"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7860, 7484
                hide_name = True
                size = 60, 20
            ]

            tag Goto53 {
                value = "is_q"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7256, 7928
                hide_name = True
                size = 60, 20
            ]

            tag From76 {
                value = "omega"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8112, 7520
                hide_name = True
                size = 58, 20
            ]

            tag Goto54 {
                value = "eta_d"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9064, 7448
                hide_name = True
                size = 60, 20
            ]

            tag Goto55 {
                value = "eta_q"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9076, 7764
                hide_name = True
                size = 60, 20
            ]

            tag Goto57 {
                value = "reset_int"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7844, 7592
                hide_name = True
                size = 60, 20
            ]

            tag From81 {
                value = "reset_int"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8608, 7736
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From82 {
                value = "reset_int"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7628, 7700
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto58 {
                value = "i_sd_ref"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7788, 7436
                hide_name = True
                size = 60, 20
            ]

            tag Goto59 {
                value = "i_sq_ref"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7792, 7560
                hide_name = True
                size = 60, 20
            ]

            tag From83 {
                value = "is_d"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8120, 7456
                hide_name = True
                size = 58, 20
            ]

            tag From84 {
                value = "is_q"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8108, 7488
                hide_name = True
                size = 58, 20
            ]

            tag From85 {
                value = "vs_d"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8108, 7556
                hide_name = True
                size = 58, 20
            ]

            tag From86 {
                value = "init_PLL"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6728, 7616
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto60 {
                value = "init_PLL"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7852, 7536
                hide_name = True
                size = 60, 20
            ]

            junction Junction1 sp
            [
                position = 7184, 7352
            ]

            junction Junction2 sp
            [
                position = 7200, 7416
            ]

            junction Junction3 sp
            [
                position = 7120, 7752
            ]

            junction Junction4 sp
            [
                position = 7116, 7868
            ]

            junction Junction5 sp
            [
                position = 8992, 7452
            ]

            junction Junction6 sp
            [
                position = 8988, 7736
            ]

            junction Junction7 sp
            [
                position = 7712, 7476
            ]

            junction Junction8 sp
            [
                position = 7724, 7508
            ]

            junction Junction9 sp
            [
                position = 7560, 8068
            ]

            comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">PLL and abc to dq transformation</p></body></html> ENDCOMMENT 
            [
                position = 6856, 7148
            ]

            comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Current references</p></body></html> ENDCOMMENT 
            [
                position = 7708, 7148
            ]

            comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">dq PI controller with feedforward voltages and cross-coupling terms cancellation</p></body></html> ENDCOMMENT 
            [
                position = 8484, 7132
            ]

            comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">dq to abc transformation</p></body></html> ENDCOMMENT 
            [
                position = 9448, 7136
            ]

            scheme_area Area4 {
                title = <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><meta charset="utf-8" /><style type="text/css">p, li { white-space: pre-wrap; }hr { height: 1px; border-width: 0; }li.unchecked::marker { content: "\2610"; }li.checked::marker { content: "\2612"; }</style></head><body style=" font-family:'Tahoma'; font-size:14pt; font-weight:100; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:1;">Peripherals AO Currents</span></p></body></html>
            }
            [
                position = 6100, 7800
                size = 364, 372
            ]

            scheme_area Area5 {
                title = <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><meta charset="utf-8" /><style type="text/css">p, li { white-space: pre-wrap; }hr { height: 1px; border-width: 0; }li.unchecked::marker { content: "\2610"; }li.checked::marker { content: "\2612"; }</style></head><body style=" font-family:'Tahoma'; font-size:14pt; font-weight:100; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:1;">Peripherals AO Voltages</span></p></body></html>
            }
            [
                position = 6100, 7380
                size = 356, 380
            ]

            scheme_area Area6 {
                title = <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Tahoma'; font-size:14pt; font-weight:0; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Peripherals</p></body></html>
            }
            [
                position = 10220, 7632
                size = 548, 508
            ]

            scheme_area Area3 {
                title = <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Tahoma'; font-size:14pt; font-weight:0; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Serial Communication</p></body></html>
            }
            [
                position = 7956, 7652
                size = 912, 532
            ]

            connect From58 "Bus Join3.in1" as Connection479
            connect From57 "Bus Join3.in" as Connection480
            connect From59 "Bus Join3.in2" as Connection481
            connect From63 "Bus Join4.in2" as Connection489
            connect "Bus Join4.in1" From62 as Connection490
            connect From61 "Bus Join4.in" as Connection491
            connect "C function PLL.e_q" Termination3.in as Connection497
            connect Goto35 "C function PLL.theta_pll" as Connection500
            connect Goto36 "C function PLL.omega_pll" as Connection502
            connect From66 "C function abc to dq.theta" as Connection504
            connect Goto37 "Bus Join5.out" as Connection507
            connect From67 "C function PI current controller.is_dq" as Connection514
            connect "Bus Join6.out" Goto38 as Connection517
            connect From68 "C function PI current controller.vs_dq" as Connection524
            connect From69 "C function PI current controller.omega_pll" as Connection525
            connect Goto40 "Bus Join8.out" as Connection553
            connect From72 "C function dq to abc.dq" as Connection554
            connect From73 "C function dq to abc.theta" as Connection555
            connect Goto41 "Bus Join9.out" as Connection559
            connect From71 "C function PI current controller.is_dq_ref" as Connection605
            connect Goto43 "ADC (Generic)1.Out" as Connection766
            connect Goto44 "ADC (Generic)2.Out" as Connection767
            connect Goto45 "ADC (Generic)3.Out" as Connection768
            connect Goto46 "ADC (Generic)4.Out" as Connection769
            connect Goto47 "ADC (Generic)5.Out" as Connection770
            connect Goto48 "ADC (Generic)6.Out" as Connection771
            connect Sum1.in From74 as Connection772
            connect Sum1.in1 Constant1.out as Connection773
            connect Sum1.out Gain1.in as Connection774
            connect "Bus Split1.in" Gain1.out as Connection775
            connect "Bus Split1.out" "ePWM (Generic)1.In1" as Connection776
            connect "ePWM (Generic)1.In2" "Bus Split1.out1" as Connection777
            connect "Bus Split1.out2" "ePWM (Generic)1.In3" as Connection778
            connect "Bus Join9.in" "C function dq to abc.a" as Connection787
            connect "C function dq to abc.c" "Bus Join9.in2" as Connection788
            connect "Bus Join9.in1" "C function dq to abc.b" as Connection789
            connect "Bus Join3.out" "C function abc to dq.abc" as Connection790
            connect "Bus Join4.out" "C function PLL.abc" as Connection791
            connect "C function PLL.d" Junction1 as Connection7536
            connect Junction1 "Bus Join6.in" as Connection7537
            [
                breakpoints = 7184, 7352
            ]
            connect Goto50 Junction1 as Connection7538
            connect "Bus Join6.in1" Junction2 as Connection7539
            [
                breakpoints = 7200, 7400; 7200, 7400
            ]
            connect Junction2 "C function PLL.q" as Connection7540
            [
                breakpoints = 7200, 7416; 7192, 7416
            ]
            connect Goto51 Junction2 as Connection7541
            connect Goto49 "Bus Join11.out" as Connection7533
            connect "C function abc to dq.d" Junction3 as Connection7542
            connect Junction3 "Bus Join5.in" as Connection7543
            [
                breakpoints = 7116, 7756
            ]
            connect Goto52 Junction3 as Connection7544
            connect "Bus Join5.in1" Junction4 as Connection7545
            [
                breakpoints = 7116, 7820
            ]
            connect Junction4 "C function abc to dq.q" as Connection7546
            [
                breakpoints = 7116, 7868
            ]
            connect Goto53 Junction4 as Connection7547
            connect "C function PI current controller.eta_d" Junction5 as Connection7551
            connect Junction5 "Bus Join8.in" as Connection7552
            [
                breakpoints = 8988, 7456
            ]
            connect Goto54 Junction5 as Connection7553
            connect "Bus Join8.in1" Junction6 as Connection7554
            [
                breakpoints = 8988, 7696
            ]
            connect Junction6 "C function PI current controller.eta_q" as Connection7555
            connect Goto55 Junction6 as Connection7556
            connect "SCI Receive1.var4" Goto57 as Connection7561
            [
                breakpoints = 7700, 7540; 7700, 7588
            ]
            connect From81 "C function PI current controller.reset_int" as Connection7563
            connect From82 "GPIO DO (Generic)1.In" as Connection7564
            connect Constant2.out "ePWM (Generic)2.In1" as Connection7565
            connect Constant3.out "C function PI current controller.v_dc" as Connection7566
            connect From76 "SCI Send1.var3" as Connection7567
            connect "SCI Receive1.var1" Junction7 as Connection7568
            [
                breakpoints = 7672, 7476
            ]
            connect Junction7 "Bus Join11.in" as Connection7569
            [
                breakpoints = 7724, 7476; 7724, 7476; 7696, 7476; 7712, 7476
            ]
            connect Goto58 Junction7 as Connection7570
            connect "SCI Receive1.var2" Junction8 as Connection7571
            connect Junction8 "Bus Join11.in1" as Connection7572
            connect Goto59 Junction8 as Connection7573
            connect From83 "SCI Send1.var1" as Connection7574
            connect From84 "SCI Send1.var2" as Connection7575
            connect From85 "SCI Send1.var4" as Connection7576
            connect Sum2.in Constant4.out as Connection7577
            connect Delay1.out Sum2.in1 as Connection7579
            connect Delay1.in Junction9 as Connection7584
            connect Junction9 Sum2.out as Connection7585
            [
                breakpoints = 7560, 8068
            ]
            connect "GPIO DO (Generic)2.In" Junction9 as Connection7586
            connect From86 "C function PLL.init_pll" as Connection7587
            connect "SCI Receive1.var3" Goto60 as Connection7588
            [
                breakpoints = 7672, 7528; 7808, 7528
            ]
        }
        [
            position = 9320, 8264
            size = 512, 416
        ]

        component Subsystem Plant {
            layout = dynamic
            component "core/Three Phase Voltage Source" Vs1 {
            }
            [
                position = 9428, 8036
                rotation = down
                scale = 1, -1
                size = 62, 256
            ]

            component "core/Series RLC Branch" "Series RLC Branch1" {
                branch_type = "RL"
                inductance = "2.5e-3"
                num_phases = "Three-Phase"
                resistance = "0.1"
            }
            [
                position = 7804, 8036
                size = 128, 256
            ]

            component "core/Series RLC Branch" "Series RLC Branch2" {
                branch_type = "RL"
                inductance = "2.5e-3"
                num_phases = "Three-Phase"
                resistance = "0.1"
            }
            [
                position = 8540, 8036
                size = 128, 256
            ]

            component "core/Series RLC Branch" "Series RLC Branch3" {
                branch_type = "RC"
                capacitance = "1e-6"
                inductance = "L_t"
                num_phases = "Three-Phase"
                resistance = "27"
            }
            [
                position = 8316, 8324
                rotation = right
                size = 128, 256
            ]

            component "core/Voltage Source" v_dc {
            }
            [
                position = 6836, 7956
                rotation = right
            ]

            component "core/Current Measurement" Iag {
            }
            [
                position = 9172, 7940
                size = 64, 32
            ]

            component "core/Voltage Measurement" Va {
            }
            [
                position = 9252, 8260
                rotation = right
                size = 64, 32
            ]

            component "core/Current Measurement" Ibg {
            }
            [
                position = 9172, 8036
                size = 64, 32
            ]

            component "core/Current Measurement" Icg {
            }
            [
                position = 9180, 8132
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vb {
            }
            [
                position = 9308, 8260
                rotation = right
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vc {
            }
            [
                position = 9372, 8260
                rotation = right
                size = 64, 32
            ]

            component "core/Ground" gnd1 {
            }
            [
                position = 9308, 8356
            ]

            component "core/Ground" gnd2 {
            }
            [
                position = 9548, 8140
            ]

            component "core/Ground" gnd3 {
            }
            [
                position = 8308, 8532
            ]

            component "core/Resistor" R1 {
                resistance = "0.001"
            }
            [
                position = 6924, 7852
            ]

            component "core/Half Bridge" "IGBT Leg1" {
                fvd_def_method = "LUT"
                pwm_enable_di = "12"
                pwm_enabling = "True"
                signal_access = "Inherit"
            }
            [
                position = 7220, 7996
                size = 80, 192
            ]

            component "core/Half Bridge" "IGBT Leg2" {
                S_bot = "4"
                S_top = "3"
                fvd_def_method = "LUT"
                pwm_enable_di = "12"
                pwm_enabling = "True"
                signal_access = "Inherit"
            }
            [
                position = 7380, 8148
                size = 80, 192
            ]

            component "core/Half Bridge" "IGBT Leg3" {
                S_bot = "6"
                S_top = "5"
                fvd_def_method = "LUT"
                pwm_enable_di = "12"
                pwm_enabling = "True"
                signal_access = "Inherit"
            }
            [
                position = 7452, 8412
                size = 80, 192
            ]

            component "core/Voltage Measurement" v_h {
            }
            [
                position = 6996, 8084
                rotation = right
                size = 64, 32
            ]

            component "core/Capacitor" C1 {
                capacitance = "2200e-6"
                initial_voltage = "365"
                signal_access = "Inherit"
            }
            [
                position = 7140, 8084
                rotation = right
            ]

            component "core/Resistor" R9 {
                resistance = "1e5"
            }
            [
                position = 7052, 8084
                rotation = right
            ]

            component "core/Capacitor" C2 {
                capacitance = "2200e-6"
                initial_voltage = "365"
                signal_access = "Inherit"
            }
            [
                position = 7140, 8292
                rotation = right
            ]

            component "core/Resistor" R10 {
                resistance = "1e5"
            }
            [
                position = 7052, 8292
                rotation = right
            ]

            junction Junction1 pe
            [
                position = 8220, 7940
            ]

            junction Junction2 pe
            [
                position = 8316, 8036
            ]

            junction Junction3 pe
            [
                position = 8412, 8132
            ]

            junction Junction4 pe
            [
                position = 8316, 8452
            ]

            junction Junction5 pe
            [
                position = 9252, 7940
            ]

            junction Junction6 pe
            [
                position = 9308, 8036
            ]

            junction Junction7 pe
            [
                position = 9372, 8132
            ]

            junction Junction8 pe
            [
                position = 9308, 8300
            ]

            junction Junction9 pe
            [
                position = 8316, 8452
            ]

            junction Junction16 pe
            [
                position = 7284, 8516
            ]

            junction Junction19 pe
            [
                position = 7188, 8516
            ]

            junction Junction22 pe
            [
                position = 7100, 8516
            ]

            junction Junction23 pe
            [
                position = 7380, 7852
            ]

            junction Junction24 pe
            [
                position = 7220, 7852
            ]

            junction Junction25 pe
            [
                position = 6996, 7852
            ]

            junction Junction18 pe
            [
                position = 7052, 8196
            ]

            junction Junction26 pe
            [
                position = 7140, 8196
            ]

            junction Junction27 pe
            [
                position = 7052, 7852
            ]

            junction Junction28 pe
            [
                position = 7052, 8004
            ]

            junction Junction29 pe
            [
                position = 7052, 8516
            ]

            junction Junction30 pe
            [
                position = 7052, 8396
            ]

            connect "Series RLC Branch1.P1_neg" Junction1 as Connection9
            connect Junction1 "Series RLC Branch2.P1_pos" as Connection10
            connect "Series RLC Branch3.P3_pos" Junction1 as Connection11
            connect "Series RLC Branch1.P2_neg" Junction2 as Connection12
            [
                breakpoints = 7980, 8036; 8316, 8036
            ]
            connect Junction2 "Series RLC Branch2.P2_pos" as Connection13
            connect "Series RLC Branch3.P2_pos" Junction2 as Connection14
            connect "Series RLC Branch1.P3_neg" Junction3 as Connection15
            [
                breakpoints = 7908, 8132; 8100, 8132; 8100, 8140; 8412, 8140
            ]
            connect Junction3 "Series RLC Branch2.P3_pos" as Connection16
            connect "Series RLC Branch3.P1_pos" Junction3 as Connection17
            connect "Series RLC Branch3.P3_neg" Junction4 as Connection19
            [
                breakpoints = 8228, 8452
            ]
            connect Junction4 "Series RLC Branch3.P2_neg" as Connection20
            connect Vs1.a_node Junction5 as Connection31
            connect Junction5 Iag.n_node as Connection32
            connect Va.p_node Junction5 as Connection33
            connect Ibg.n_node Junction6 as Connection34
            connect Junction6 Vs1.b_node as Connection35
            connect Vb.p_node Junction6 as Connection36
            [
                breakpoints = 9300, 8220; 9300, 8036
            ]
            connect Icg.n_node Junction7 as Connection37
            connect Junction7 Vs1.c_node as Connection38
            connect Vc.p_node Junction7 as Connection39
            [
                breakpoints = 9372, 8220; 9372, 8132
            ]
            connect Vc.n_node Vb.n_node as Connection40
            connect Va.n_node Junction8 as Connection42
            connect Junction8 Vb.n_node as Connection43
            connect gnd1.node Junction8 as Connection44
            connect gnd2.node Vs1.n_node as Connection45
            connect "Series RLC Branch3.P1_neg" Junction9 as Connection46
            connect Junction9 Junction4 as Connection47
            connect gnd3.node Junction9 as Connection48
            connect R1.p_node v_dc.p_node as Connection53
            connect Junction16 "IGBT Leg3.neg_out" as Connection79
            connect "IGBT Leg2.neg_out" Junction16 as Connection80
            connect "IGBT Leg1.a_in" "Series RLC Branch1.P1_pos" as Connection88
            [
                breakpoints = 7276, 7940; 7724, 7940
            ]
            connect "Series RLC Branch1.P2_pos" "IGBT Leg2.a_in" as Connection89
            connect "Series RLC Branch1.P3_pos" "IGBT Leg3.a_in" as Connection90
            connect Junction19 Junction16 as Connection92
            connect Junction19 "IGBT Leg1.neg_out" as Connection98
            [
                breakpoints = 7188, 8516; 7188, 8516
            ]
            connect v_dc.n_node Junction22 as Connection108
            connect Junction22 Junction19 as Connection109
            connect "IGBT Leg2.pos_out" Junction23 as Connection113
            connect Junction23 "IGBT Leg3.pos_out" as Connection114
            [
                breakpoints = 7380, 7852; 7452, 7852
            ]
            connect Junction24 Junction23 as Connection117
            connect "IGBT Leg1.pos_out" Junction24 as Connection118
            connect R1.n_node Junction25 as Connection119
            connect v_h.p_node Junction25 as Connection121
            connect R9.n_node Junction18 as Connection122
            connect Junction18 R10.p_node as Connection123
            connect C2.p_node Junction26 as Connection111
            connect Junction26 Junction18 as Connection112
            connect C1.n_node Junction26 as Connection124
            connect Junction25 Junction27 as Connection125
            connect Junction27 Junction24 as Connection126
            connect R9.p_node Junction28 as Connection128
            connect Junction28 Junction27 as Connection129
            connect C1.p_node Junction28 as Connection130
            connect v_h.n_node Junction29 as Connection131
            connect Junction29 Junction22 as Connection132
            connect R10.n_node Junction30 as Connection134
            connect Junction30 Junction29 as Connection135
            connect C2.n_node Junction30 as Connection136
            connect "Series RLC Branch2.P1_neg" Iag.p_node as Connection137
            connect "Series RLC Branch2.P2_neg" Ibg.p_node as Connection138
            connect "Series RLC Branch2.P3_neg" Icg.p_node as Connection139
            [
                breakpoints = 9140, 8132
            ]
        }
        [
            position = 8704, 8264
            size = 584, 424
        ]

        component "TI C2000 Toolbox/TI C2000 Setup" "TI RCP Setup1" {
            build_and_deploy_action = "False"
            c2000ware_root_path = "C:\ti\c2000\C2000Ware_5_04_00_00"
            ccs_project_name = "dq_current_ctrl_acg"
            ccs_project_path = "c:\workspace\typhoon_use\auto_code_gen\vsc_use\updated"
            ccs_root_path = "C:\ti\ccs1271"
            exp_subsys_name = "dq_current_ctrl"
        }
        [
            position = 9752, 8172
            size = 64, 64
        ]
    }

    default {
        "core/Bus Join" {
            inputs = "2"
            execution_rate = "inherit"
        }

        "core/Bus Split" {
            outputs = "2"
            execution_rate = "inherit"
        }

        "core/C function" {
            input_terminals = "real in;"
            input_terminals_show_labels = "False;"
            input_terminals_feedthrough = "True;"
            input_terminals_dimensions = "inherit;"
            output_terminals = "real out;"
            output_terminals_show_labels = "False;"
            output_terminals_feedthrough = "True;"
            output_terminals_dimensions = "inherit;"
            output_fnc = ""
            update_fnc = ""
            init_fnc = ""
            global_variables = ""
            parameters = ""
            library_load_type = "Compile-time load"
            dll_file_path = ""
            dll_file_path_full = ""
            arm_a9_file_path = ""
            arm_a9_file_path_full = ""
            arm_a53_file_path = ""
            arm_a53_file_path_full = ""
            h_file_path = ""
            h_file_path_full = ""
            add_src_path = ""
            add_src_path_full = ""
            convert_to_relative_dll = "True"
            convert_to_relative_a = "True"
            convert_to_relative_src = "True"
            arb_defs = ""
            add_macros = ""
            skip_pre_cmpl_check = "False"
            generate_for_hil = "True"
            execution_rate = "inherit"
            _supported_platforms = "[\'generic\']"
            refresh = "refresh"
        }

        "core/Capacitor" {
            signal_access = "inherit"
            capacitance = "1e-6"
            initial_voltage = "0"
            pole_shift_ignore = "False"
            visible = "True"
        }

        "core/Constant" {
            value = "1"
            signal_type = "real"
            execution_rate = "100e-6"
            _tunable = "False"
        }

        "core/Delay" {
            delay_type = "Fixed delay"
            del_length = "2"
            max_delay_length = "20"
            init_value = "0"
            signal_out_type = "inherit"
            execution_rate = "inherit"
        }

        "core/Gain" {
            gain = "1"
            multiplication = "Element-wise(K.*u)"
            _tunable = "False"
            execution_rate = "inherit"
        }

        "core/Resistor" {
            resistance = "1"
            param_set = ""
        }

        "core/Sum" {
            signs = "2"
            execution_rate = "inherit"
        }

        "core/Termination" {
            execution_rate = "inherit"
        }

        "core/Voltage Source" {
            sig_input = "False"
            type = "signal generator"
            param_set = "1phase"
            parent_label = ""
            dtsm_switch_name = ""
            addr = "0"
            spc_nb = "0"
            execution_rate = "100e-6"
            cpd_visible = "True"
            enable_snb = "False"
            snb_type = "R2"
            R2 = "0.0"
            L1 = "0.1"
            override_signal_name = "False"
            signal_name = ""
            init_source_nature = "Constant"
            init_const_value = "0.0"
            init_rms_value = "0.0"
            init_frequency = "50.0"
            init_phase = "0.0"
        }

        "TI C2000 Toolbox/ADC (Generic)" {
            hil_ao_nr = "1"
            interface_type = "HIL TI Launchpad Interface"
            controller_index = "1"
            scaling = "1"
            offset = "0"
            execution_rate = "100e-6"
            conv_trigger = "Software Only"
            inten = "False"
        }

        "core/Current Measurement" {
            signal_access = "inherit"
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }

        "TI C2000 Toolbox/GPIO DO (Generic)" {
            hil_di_nr = "1"
            pin_action = "Set"
            interface_type = "HIL TI Launchpad Interface"
            controller_index = "1"
            execution_rate = "100e-6"
        }

        "core/Half Bridge" {
            signal_access = "inherit"
            model_type = "Global GDS oversampling"
            ctrl_src = "Digital input per switch"
            op_mode = "Fixed carrier frequency"
            carrier_freq = "10000.0"
            phase_op_mode = "Fixed carrier phase offset"
            carr_ph_offset = "0.0"
            d_time = "5e-6"
            ref_sig_min_max = "[-1.0, 1.0]"
            load_mode = "on min"
            execution_rate = "inherit"
            S_top = "1"
            S_top_logic = "active high"
            S_bot = "2"
            S_bot_logic = "active high"
            S_top_I = "False"
            S_bot_I = "False"
            _control_property = "all high"
            switches_names_at_mask = "[]"
            pwm_enabling = "False"
            pwm_enable_di = "13"
            pwm_enable_inv = "active high"
            delay_enabled = "False"
            fixed_delay = "1e-6"
            var_delay_lut = "[-10.0, 1e-6, 10.0, 1e-6]"
            preview_var_delay = "Preview"
            vout_cmp_pullup_mode = "False"
            vout_cmp_timeout = "5e-6"
            show_monitoring = "False"
            fvd = "False"
            losses_estimation = "False"
            fvd_def_method = "Voltage and Resistance"
            Import_igbt_xml = "not selected"
            Import_diode_xml = "not selected"
            Switch_type = "IGBT"
            Vce = "1.3"
            Rce = "0"
            Vd = "1.2"
            Rd = "0"
            i_sw = "[0.0, 6.0, 12.0, 18.0, 24.0]"
            v_sw = "[0.0, 600.0]"
            temp_sw = "[25.0, 50.0, 75.0, 100.0, 125.0]"
            vce_table_out = "[1.3, 1.3, 1.3, 1.3, 1.3]"
            vd_table_out = "[1.2, 1.2, 1.2, 1.2, 1.2]"
            et_on_table_out = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*3.8e-3, 0.4*3.8e-3, 0.8*3.8e-3, 0.68*3.8e-3, 0.9*3.8e-3], [0.65*3.8e-3, 0.9*3.8e-3, 1.2*3.8e-3, 1.5*3.8e-3, 1.7*3.8e-3], [0.9*3.8e-3, 1.3*3.8e-3, 1.7*3.8e-3, 1.9*3.8e-3, 2.25*3.8e-3], [1.1*3.8e-3, 1.7*3.8e-3, 2.1*3.8e-3, 2.3*3.8e-3, 2.5*3.8e-3]]"
            et_off_table_out = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*2.1e-3, 0.4*2.1e-3, 0.8*2.1e-3, 0.68*2.1e-3, 0.9*2.1e-3], [0.65*2.1e-3, 0.9*2.1e-3, 1.2*2.1e-3, 1.5*2.1e-3, 1.7*2.1e-3], [0.9*2.1e-3, 1.3*2.1e-3, 1.7*2.1e-3, 1.9*2.1e-3, 2.25*2.1e-3], [1.1*2.1e-3, 1.7*2.1e-3, 2.1*2.1e-3, 2.3*2.1e-3, 2.5*2.1e-3]]"
            ed_off_table_out = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*2.2e-3, 0.4*2.2e-3, 0.8*2.2e-3, 0.68*2.2e-3, 0.9*2.2e-3], [0.65*2.2e-3, 0.9*2.2e-3, 1.2*2.2e-3, 1.5*2.2e-3, 1.7*2.2e-3], [0.9*2.2e-3, 1.3*2.2e-3, 1.7*2.2e-3, 1.9*2.2e-3, 2.25*2.2e-3], [1.1*2.2e-3, 1.7*2.2e-3, 2.1*2.2e-3, 2.3*2.2e-3, 2.5*2.2e-3]]"
            temp_estimation = "False"
            thermal_networks_type = "Foster"
            switch_Rth = "[0.159, 0.133, 0.120, 0.038]"
            switch_Tth = "[1.1e-1, 1.56e-2, 1.35e-3, 1.51e-4]"
            switch_Cth = "[0.0029, 0.0097, 0.1068, 0.8500]"
            diode_Rth = "[0.159, 0.133, 0.120, 0.038]"
            diode_Tth = "[1.1e-1, 1.56e-2, 1.35e-3, 1.51e-4]"
            diode_Cth = "[0.0029, 0.0097, 0.1068, 0.8500]"
            loss_exec_rate = "100e-6"
            visualize_luts = "Visualize Lookup Tables"
            show_cnt_out = "False"
            PESB_Optimization = "True"
            dtv_flag_en = "True"
            reserved_parameter1 = "0"
            predictive_diode_turn_off = "False"
        }

        "TI C2000 Toolbox/SCI Receive (Generic)" {
            vct_size = "1"
            var_names = "var1"
            var1 = ""
            var2 = ""
            var3 = ""
            var4 = ""
            execution_rate = "1e-3"
            timeout = "0.1"
            change_names = "False"
        }

        "TI C2000 Toolbox/SCI Send (Generic)" {
            vct_size = "1"
            var_names = "var1"
            var1 = ""
            var2 = ""
            var3 = ""
            var4 = ""
            sending_prd = "on ping"
            change_names = "False"
        }

        "TI C2000 Toolbox/SCI Setup (Generic)" {
            sci_module = "a"
            lspclkdiv = "1"
            lspclk = "1"
            baudrate = "460800"
            scihbaud = "0"
            scilbaud = "12"
            probe_connection = "True"
            ti_tx_gpio = "42"
            ti_rx_gpio = "43"
            parityena = "False"
            parity = "Odd"
            stopbits = "1"
            scichar = "7"
            sciffena = "1"
            scirst = "1"
            swreset = "1"
            rxena = "1"
            txena = "1"
            rxfiforeset = "1"
            txfiforeset = "1"
            txfifoxreset = "1"
            execution_rate = "1e-3"
        }

        "core/Series RLC Branch" {
            num_phases = "Single-Phase"
            branch_type = "RLC"
            resistance = "10"
            inductance = "10e-3"
            initial_current = "0"
            capacitance = "10e-6"
            initial_voltage = "0"
        }

        "TI C2000 Toolbox/TI C2000 Setup" {
            build_and_deploy = "Build and deploy"
            build_and_deploy_action = "0"
            create_ccs_project = "Create CCS Project"
            create_ccs_project_action = "False"
            export = "Export code"
            export_action = "False"
            build = "Build"
            build_action = "False"
            flash = "Flash target"
            flash_action = "False"
            ex_rate_test = "Perform execution rate test"
            ex_rate_test_action = "False"
            exp_subsys_name = ""
            ccs_project_name = ""
            model_path_en = "True"
            ccs_project_path = "c:\git\t_mdl\010_ti_rcp_lib\ti_rcp_lib_v1"
            target_platform = "LAUNCHXL-F28379D"
            execution_rate = "100e-6"
            ccs_root_path = "C:\User Programs\ti"
            c2000ware_root_path = "C:\ti\C2000Ware_5_02_00_00"
            write_settings = "Write settings"
            scheduling = "CPU Timer Based Scheduler"
        }

        "core/Three Phase Voltage Source" {
            init_rms_value = "0.0"
            init_frequency = "50.0"
            init_phase = "0.0"
        }

        "core/Voltage Measurement" {
            signal_access = "inherit"
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }

        "TI C2000 Toolbox/ePWM (Generic)" {
            hil_di_nr = "1"
            hil_di_nr_b = "2"
            interface_type = "HIL TI Launchpad Interface"
            controller_index = "1"
            nr_of_channels = "1"
            freq_op_mode = "Fixed carrier frequency"
            frequency = "10e3"
            phase_op_mode = "Fixed carrier phase offset"
            carr_ph_offset = "0"
            dead_time = "5e-7"
            load_mode = "on min"
            clock_time_ti = "5e-9"
            clock_time_emulator = "5e-9"
            soc_en = "False"
            soc_timing = "Counter equals zero"
            soc_period = "Every event"
            int_en = "False"
            int_timing = "Counter equals zero"
            int_period = "Every event"
        }
    }

    CODE model_init
        # Numpy module is imported as 'np'
        # Scipy module is imported as 'sp'
        # The Schematic API is imported as 'mdl'
        # To get the model file path, use 'mdl.get_model_file_path()'
        # To print information to the console, use info()
        
        omega = 2*np.pi*50
        L_t = 2.5e-3
        C = 1e-6
        L_s = 2.5e-3
        R_d = 27
        R_t = omega*L_t/10
        R_s = omega*L_s/10
        Ts = 50e-6
        AO_offset = 1.5
        I_scale = 90/3 #105 max volta - (-150) min voltage. 3 max voltage DSP
        V_scale = 720/3 #360 max volta - (-360) min voltage. 3 max voltage DSP
        Tslow = 100e-3
        Ts_Control = 50e-6
        
        #PLL control gains
        K_p_pll = 1.8
        K_i_pll = 1.8/0.00251
        
        # PI current controller gains
        tau_c = 1e-3
        L = L_s + L_t
        R = R_s + R_t
        Kp_i = L/tau_c
        Ki_i = R/tau_c
        
        #Ton contactor
        T_on_contactor = 0.1
    ENDCODE
}
